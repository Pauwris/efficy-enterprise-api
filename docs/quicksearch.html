<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"remote-objects_attachment_type.mjs.html":{"id":"remote-objects_attachment_type.mjs.html","title":"Source: remote-objects/attachment/type.mjs","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Source: remote-objects/attachment/type.mjs /** * Class representing a remotely fetched Attachment */ class AttachmentObject { key; #stream; constructor(key) { this.key = key; } setStream(stream) { this.#stream = stream; } /** * get the base64 encoded attachment stream * @type {string} */ get base64Stream() { return this.#stream; } get func() { const func = {}; func[\"@name\"] = \"attachment\"; func[\"key\"] = this.key; return func; }; } export default AttachmentObject; × Search results Close Efficy Enterprise API for Node.js and browser "},"remote-objects_api.mjs.html":{"id":"remote-objects_api.mjs.html","title":"Source: remote-objects/api.mjs","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Source: remote-objects/api.mjs import RemoteObject from './remote-object.mjs'; import DataSetObject from './dataset/dataset-object.mjs'; /** * Class returned by methods such as getCategoryCollection * @extends DataSetObject */ export class CollectionObject extends DataSetObject { constructor(remoteAPI, entity, detail) { super(remoteAPI); this.dataSetName = \"collection\"; this.entity = entity; this.detail = detail; } asJsonRpc() { const api = { \"@name\": \"getcategorycollection\" } if (this.entity) api.entity = this.entity; if (this.detail) api.detail = this.detail; const requestObject = { \"#id\": this.id, \"@name\": \"api\", \"@func\": [api] }; return requestObject; } } /** * Class returned by methods such as deleteEntity * @extends RemoteObject */ export class DeleteEntity extends RemoteObject { constructor(remoteAPI, entity, keys) { super(remoteAPI); this.entity = entity; this.keys = Array.isArray(keys) ? keys : [keys]; this.api.registerObject(this); } asJsonRpc() { const api = { \"@name\": \"delete\", \"entity\": this.entity, \"keys\":this.keys.join(\";\") } const requestObject = { \"#id\": this.id, \"@name\": \"api\", \"@func\": [api] }; return requestObject; } } × Search results Close Efficy Enterprise API for Node.js and browser "},"remote-objects_dataset_dataset-object.mjs.html":{"id":"remote-objects_dataset_dataset-object.mjs.html","title":"Source: remote-objects/dataset/dataset-object.mjs","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Source: remote-objects/dataset/dataset-object.mjs import RemoteObject from '../remote-object.mjs'; import DataSet from './type.mjs'; /** * Represents a remotely fetched Efficy DataSet transformed as an array of row items * @extends RemoteObject */ class DataSetObject extends RemoteObject { #items; #item; constructor(remoteAPI) { super(remoteAPI); this.api.registerObject(this); } /** @protected */ dataSetName; /** @protected */ afterExecute() { super.afterExecute(); const dso = new DataSet(\"main\"); dso.setItems(this.api.findDataSetArray(this.responseObject, this.dataSetName)); this.#items = dso.items; this.#item = dso.item; } /** * The to array converted dataset * @type {array} */ get items() { return this.#items; } /** * When exists, the first item of the items array, else null * @type {array} */ get item() { return this.#item; } } export default DataSetObject; × Search results Close Efficy Enterprise API for Node.js and browser "},"remote-objects_consult.mjs.html":{"id":"remote-objects_consult.mjs.html","title":"Source: remote-objects/consult.mjs","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Source: remote-objects/consult.mjs import RemoteAPI from '../remote-api.mjs'; import RemoteObject from './remote-object.mjs'; import DataSetList from './dataset/list.mjs'; import {ParseGentle} from './utils/parsing.mjs'; import DataSetObject from './dataset/dataset-object.mjs'; /** * Class returned by openConsultObject * @extends RemoteObject * @property {string} entity - The entity name of the consulted record * @property {number} key - The key of the consulted record * @property {number} consulthandle - The handle of the consult operation * @property {object} data - The master, categories and detail objects available as properties of data */ class ConsultObject extends RemoteObject { entity; key; consulthandle; data; /** @protected */ closecontext; #otherFuncs; #dataSetList; #isDirty; /** * Opens an consult context for the record identified by entity and key. * A context remains memory-resident (on the web server) until it is closed. Always match with a closeContext() call to avoid memory consumption. * @param {RemoteAPI} remoteAPI * @param {string} entity - The entity name of the consulted record, e.g. \"Comp\" * @param {number} key - The key of the consulted record * @param {number} [consultHandle] - Possibility to pass an existing consultHandle */ constructor(remoteAPI, entity, key, consultHandle) { super(remoteAPI); this.entity = entity; this.key = ParseGentle.toFloatKey(key); this.consulthandle = consultHandle; this.#dataSetList = new DataSetList(remoteAPI); this.#resetState(); this.#setDirty(); } #resetState() { this.closecontext = null; this.#otherFuncs = []; this.#dataSetList.resetState(); this.#isDirty = false; } #setDirty() { if (this.#isDirty) return; this.api.registerObject(this); this.#isDirty = true; } /** * Retrieves a master [DatasetObject]{@link Dataset.html} from the consult context. * @returns {DataSetObject} */ getMasterDataSet() { this.#setDirty(); return this.#dataSetList.getMasterDataSet(); } /** * Retrieves the [DataSet]{@link Dataset.html} for category categoryName. Can be null when the category is not available to the current user. * @param {string} categoryName - name of the category, e.g. \"DOCU$INVOICING\" * @returns {DataSetObject} */ getCategoryDataSet(categoryName) { this.#setDirty(); return this.#dataSetList.getCategoryDataSet(categoryName); } /** * Retrieves a relation [DataSet]{@link Dataset.html} for the specified detail in the edit context. * @param {string} detail - The detail name, e.g. \"Comp\" * @param {string} [filter=\"\"] - SQL filter expression, e.g. \"COMMENT like '%template%'\" * @param {boolean} [includeBlobContent=false] - If true, blob fields (e.g. memo, stream) are returned * @returns {DataSetObject} */ getDetailDataSet(detail, filter = \"\", includeBlobContent = false) { this.#setDirty(); return this.#dataSetList.getDetailDataSet(detail, filter, includeBlobContent); } /** * Closes the context and frees the memory on the web server. */ closeContext() { this.closecontext = true; this.#setDirty(); } /** @protected */ asJsonRpc() { const requestObject = { \"#id\": this.id, \"@name\": \"consult\", \"@func\": [] }; // lowercase properties are required for the case sensitive JSON RPC [\"entity\", \"key\", \"consulthandle\", \"closecontext\"].forEach(property =&gt; { if (this[property] != null) requestObject[property] = this[property]; }); requestObject[\"@func\"].push(...this.#dataSetList.funcs); requestObject[\"@func\"].push(...this.#otherFuncs); return requestObject; } /** @protected */ afterExecute() { super.afterExecute(); // lowercase properties are required for the case sensitive JSON RPC [\"entity\", \"key\", \"consulthandle\", \"closecontext\"].forEach(property =&gt; { this[property] = this.responseObject[property]; }); this.#dataSetList.setResponseObject(this.responseObject); this.#dataSetList.afterExecute(); this.#dataSetList.setData(this); this.#resetState(); } } export default ConsultObject; × Search results Close Efficy Enterprise API for Node.js and browser "},"crm-env.mjs.html":{"id":"crm-env.mjs.html","title":"Source: crm-env.mjs","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Source: crm-env.mjs /** * Class to define the parameters of the Efficy Enterprise server */ class CrmEnv { #name = \"CrmEnv\"; #isNode = (typeof process !== \"undefined\" &amp;&amp; process?.versions?.node ? true : false); #isEfficy = false; /** * Create a Crm Environment. Set null when executed from browser * @param {Object} [env] - The definition object of the targeted CRM environment * @param {string} [env.url=\"\"] - The URL of Efficy Enterprise, e.g. https://mycompany.efficy.cloud/. Set null when executed from browser * @param {string} [env.customer=\"\"] - The optional customer profile name * @param {boolean} [env.logOff=false] - if true, logoff the session after the next executeBatch(); * @param {string} [env.apiKey=\"\"] - The API Key, if user and password are not used * @param {string} [env.user=\"\"] - The user credential * @param {string} [env.pwd=\"\"] - The password credential * @param {array} [env.cookies=[]] - Optional cookie setting * @example * new CrmEnv({ * \"url\": \"https://mycompany.efficy.cloud/\", * \"apiKey\": \"86E353284C0C4A848F7ADEA13589C8B6\" * }); * @tutorial CRM Environment */ constructor(env) { if (typeof env === \"object\") { this.setEnv(env); } else { this.#isEfficy = true; this.setEnv({ url: window.location.origin }); } this.#validate(); } /** * Update the Crm Environment set by the constructor * @param {Object} env - The definition object of the targeted CRM environment * @param {string} [env.url=\"\"] - The URL of Efficy Enterprise, e.g. https://mycompany.efficy.cloud/. Leave empty when executed from browser * @param {string} [env.customer=\"\"] - The optional customer profile name * @param {boolean} [env.logOff=false] - if true, logoff the session after the next executeBatch(); * @param {string} [env.apiKey=\"\"] - The API Key, if user and password are not used * @param {string} [env.user=\"\"] - The user credential * @param {string} [env.pwd=\"\"] - The password credential * @param {array} [env.cookies=[]] - Optional cookie setting */ setEnv(env) { this.url = env.url || \"\"; // e.g. \"https://customer.efficy.com\"; this.customer = env.customer || \"\"; this.logOff = typeof env.logOff === \"boolean\" ? env.logOff : false; // Sensitive properties this.apiKey = env.apiKey || \"\"; this.user = env.user || \"\"; this.pwd = env.pwd || \"\"; this.cookies = env.cookies || []; // Replace last \"/\" with \"\"; this.url = this.url.replace(/\\/$/,\"\"); this.#validate(); } #validate() { if (!this.#isEfficy &amp;&amp; !this.user &amp;&amp; !this.apiKey) throw new TypeError(`${this.#name}.validate::apiKey or user are not specified`); } /** * Returns true if this code runs in node.js * @type {boolean} */ get isNode() { return this.#isNode; } /** * Returns true if this code runs on the browser * @type {boolean} */ get isEfficy() { return this.#isEfficy; } /** * Returns the request header \"cookie\", e.g. 'EfficySession=3B826396-22AE9698' * @type {string} */ get cookieHeader() { if (Array.isArray(this.cookies)) { const header = this.cookies .filter(cookie =&gt; new Date() &lt; new Date(cookie.expires)) .map(cookie =&gt; [cookie.name, cookie.value].join(\"=\")).join(\"; \"); return header; } return \"\"; } /** * Returns the session ID, e.g. '3B826396-22AE9698' * @type {string} */ get sessionId() { return Array.isArray(this.cookies) &amp;&amp; this.cookies.length &gt; 0 ? this.cookies[0].value: \"\"; } /** * Returns the first part of the session ID, e.g. '3B826396' * @type {string} */ get shortSessionId() { return this.sessionId.split(\"-\")[0]; } } export default CrmEnv × Search results Close Efficy Enterprise API for Node.js and browser "},"crm-rpc.mjs.html":{"id":"crm-rpc.mjs.html","title":"Source: crm-rpc.mjs","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Source: crm-rpc.mjs import CrmEnv from './crm-env.mjs'; import RemoteAPI from './remote-api.mjs'; import WsObject from './ws-objects/ws-object.mjs'; import ConsultObject from './remote-objects/consult.mjs'; import EditObject from './remote-objects/edit.mjs'; import EditRelationObject from './remote-objects/edit-relation.mjs'; import SearchObject from './remote-objects/search.mjs'; import {DeleteEntity, CollectionObject} from './remote-objects/api.mjs'; import DataSetObject from './remote-objects/dataset/dataset-object.mjs'; import QueryObject from './remote-objects/dataset/query.mjs'; import QuerySQLObject from './remote-objects/dataset/query-sql.mjs'; import ConsultManyEx from './remote-objects/dataset/consult-many-ex.mjs'; import RecentList from './remote-objects/dataset/recent-list.mjs'; import FavoriteList from './remote-objects/dataset/favorite-list.mjs'; import UserList from './remote-objects/dataset/user-list.mjs'; import ContactsList from './remote-objects/dataset/contacts-list.mjs'; import ListObject from './remote-objects/list/list-object.mjs'; import SystemSettings from './remote-objects/list/system-settings.mjs'; import StringObject from './remote-objects/base-type/string-object.mjs'; import SettingObject from './remote-objects/base-type/setting-object.mjs'; import PropertyObject from './remote-objects/base-type/property-object.mjs'; /** * Class to create Remote Objects * @extends RemoteAPI */ class CrmRpc extends RemoteAPI { /** * Construct a CrmRpc object * @param {CrmEnv} [crmEnv=undefined] - When empty, uses the Efficy context of the browser * @param {function} [logFunction=undefined] - Your (custom) log function to call for requests and responses, e.g. console.log * @param {number} [threadId=undefined] - Unique thread ID for logging purposes * @example * function logger(msg, reqLog) { * console.log(msg); * } * const crm = new CrmRpc(crmEnv, logger); */ constructor(crmEnv, logFunction, threadId) { super(crmEnv, logFunction, threadId); } /** * Execute all assembled and queued RPC operations */ async executeBatch() { return super.executeBatch(); } /** * Logoff the remote session, not possible when crmEnv.isEfficy === true */ logoff() { return super.logoff(); } /** * Retrieves the alias (name) of the currently connected database * @returns {PropertyObject} */ get currentDatabaseAlias() { return new PropertyObject(this, \"currentdatabasealias\"); } /** * Retrieves the current database timezone * @returns {PropertyObject} */ get currentDatabaseTimezone() { return new PropertyObject(this, \"currentdatabasetimezone\"); } /** * Retrieves the current license name * @returns {PropertyObject} */ get currentLicenseName() { return new PropertyObject(this, \"currentlicensename\"); } /** * Retrieves the current user full name * @returns {PropertyObject} */ get currentUserFullName() { return new PropertyObject(this, \"currentuserfullname\"); } /** * Retrieves the group memberships of the current user as semicolon separated string list, e.g. \"1;28;292;936\" * @returns {PropertyObject} */ get currentUserGroups() { return new PropertyObject(this, \"currentusergroups\"); } /** * Retrieves the current user key, e.g. \"4\" * @returns {PropertyObject} */ get currentUserId() { return new PropertyObject(this, \"currentuserid\"); } /** * Retrieves the current user code, e.g. \"CRM01\" * @returns {PropertyObject} */ get currentUserCode() { return new PropertyObject(this, \"currentusername\"); } /** * Retrieves the current user timezone * @returns {PropertyObject} */ get currentUserTimezone() { return new PropertyObject(this, \"currentusertimezone\"); } /** * Opens a consult context for the record identified by entity and key. * A context remains memory-resident (on the web server) until it is closed. Always match with a closeContext() call to avoid memory consumption. * @param {string} entity - The entity name, e.g. \"Comp\" * @param {number} key - The key of the record. Use key = 0 to create a new record. * @returns {ConsultObject} * @example * const comp = crm.openConsultObject(\"comp\", 2); * const dsComp = comp.getMasterDataSet(); * const dsCompAddress = comp.getCategoryDataSet(\"COMP$ADDRESS\"); * const linkedContacts = comp.getDetailDataSet(\"cont\"); * await crm.executeBatch(); * const companyNames = [comp.data.master.NAME, comp.data.category[\"COMP$ADDRESS\"].NAME]; * comp.closeContext(); * await crm.executeBatch(); */ openConsultObject(entity, key) { return new ConsultObject(this, entity, key); } /** * Create and return an ConsultObject based on an existing consultHandle * @param {number} consultHandle * @param {string} entity - Weird, but the RPC interface requires the entity of the consultHandle! */ getConsultObject(consultHandle, entity) { return new ConsultObject(this, entity, 0, consultHandle); } /** * Opens an edit context for the record identified by entity and key. * A context remains memory-resident (on the web server) until it is closed. Always match with a closeContext() call to avoid memory consumption. * @param {string} entity - The entity name, e.g. \"Comp\" * @param {number} [key=0] - The key of the record. Use key = 0 to create a new record. * @returns {EditObject} * @example * const docu = crm.openEditObject(\"docu\", 0); * docu.updateField(\"NAME\", \"Jan\"); * docu.insertDetail(\"Comp\", 2); * docu.insertDetail(\"Cont\", 44395, true, true); * docu.commitChanges(); * docu.activateCategory(\"DOCU$INVOICING\"); * docu.updateCategoryFields(\"DOCU$INVOICING\", { * \"D_INVOICE\":\"2021-01-08T00:00:00\", * \"COMMUNICATION\": \"Hello World!\" * }); * docu.updateCategoryField(\"DOCU$INVOICING\", \"PRE_PAID\", 123.456) * docu.clearDetail(\"Comp\"); * docu.insertDetail(\"Comp\", 4); * docu.insertDetail(\"Cont\", 50512, false); * docu.insertDetail(\"Prod\", 4); * docu.updateDetail(\"Prod\", 0, { * QUANTITY: 5 * }); * docu.setUsers([169, 170], true); * docu.setUserSecurity(99999002, 271); * docu.setReference(99999001); * docu.commitChanges(); * docu.closeContext(); * await crm.executeBatch(); */ openEditObject(entity, key = 0) { return new EditObject(this, 0, entity, key); } /** * Opens an edit context for a relation. If the relation does not yet exist, it is created. * A context remains memory-resident (on the web server) until it is closed. Always match with a closeContext() call to avoid memory consumption. * @param {string} entity - The entity name, e.g. \"Comp\" * @param {string} detail - The detail name, e.g. \"Cont\" * @param {number} key - The key of the entity * @param {number} detailKey - The key of the detail * @param {number} [relationId] - The key of the relation if multi-relation is available * @returns {EditRelationObject} * @example * const contCont = crm.openEditRelationObject(\"cont\", \"cont\", 5, 6); * contCont.updateField(\"RELATION\", 1); * contCont.updateReciprocityField(\"RELATION\", 2); * contCont.commitChanges(); * const dsContCont = contCont.getMasterDataSet(); * const dsContCont1 = contCont.getMasterDataSet(1); * await crm.executeBatch(); * console.log(dsContCont.item[\"R_RELATION\"]); * console.log(dsContCont1.item[\"R_RELATION\"]); * contCont.closingCommit(); * await crm.executeBatch(); */ openEditRelationObject(entity, detail, key, detailKey, relationId) { return new EditRelationObject(this, 0, entity, detail, key, detailKey, relationId); } /** * Create and return an EditObject based on an existing editHandle * @param {number} editHandle */ getEditObject(editHandle) { return new EditObject(this, editHandle, \"\", 0); } /** * Create and return an EditObject based on an existing editHandle * @param {number} editHandle */ getEditRelationObject(editHandle) { return new EditRelationObject(this, editHandle, \"\", \"\", 0, 0); } /** * Performs a search on the database and returns the data set with search results. * @param {string} entity - The entity name, e.g. \"Comp\" * @param {string} method - The field to be searched. Special values SEARCHFAST, SEARCHFULL, SEARCHTEXT, SEARCHFILENAME, SEARCHFILE correspond to the search options in the web application user interface * @param {string} value - The value to search * @param {boolean} [own=false] - If true, search own records only. * @param {boolean} [contains=true] - If true, allow matches on part of field * @param {boolean} [opened=true] - If true, search for opened or active records only * @returns {DataSetObject} * @example * const compSearch = crm.search(\"comp\", \"SEARCHFAST\", \"Efficy\"); */ search(entity, method, value, own = false, contains = true, opened = true) { return new SearchObject(this, entity, method, value, own, contains, opened); } /** * Returns all the Contacts having one of the e-mail provided in their e-mail fields (or in the Cont_Comp relation). * @param {Array&lt;string&gt;} recipients - The list of email addresses * @returns {DataSetObject} * @example * const contactsByEmail = crm.searchContactsByEmail([\"john.doe@efficy.com\", \"john.doe@outlook.com\"]); */ searchContactsByEmail(recipients) { if (!Array.isArray(recipients) || recipients.length &lt; 1) throw TypeError(\"recipients is not a array with at least one item\"); return new ContactsList(this, recipients); } /** * Returns all the first Contacts having a match with the provided (formatted) phone number * @param {string} phoneNumber - The phone number, doesn't have to be stripped from formatting * @returns {DataSetObject} * @example * const contactsByPhone = crm.searchContactsByPhone(\"+32 474 00 00 00\"); */ searchContactsByPhone(phoneNumber) { return new ContactsList(this, undefined, phoneNumber); } /** * Executes a database query stored in QUERIES * @param {number} idQuery * @param {array} [queryParameters] - The query parameters delivered via a JS Array * @param {boolean} [loadBlobs=false] - If true, blob fields (e.g. memo, stream) are returned * @param {number} [recordCount=0] - If 0, return all records * @returns {DataSetObject} * @example * const tags = crm.executeDatabaseQuery(99990034); // Query \"Standard: Top company tags\" */ executeDatabaseQuery(idQuery, queryParameters, loadBlobs = false, recordCount = 0) { return new QueryObject(this, idQuery, null, null, queryParameters, loadBlobs, recordCount); } /** * Executes a system database query stored in SYS_QUERIES * @param {number} master * @param {number} detail * @param {array} queryParameters - The query parameters delivered via a JS Array * @param {boolean} [loadBlobs=false] - If true, blob fields (e.g. memo, stream) are returned * @param {number} [recordCount=0] - If 0, return all records * @returns {DataSetObject} * @example * const contDupls = crm.executeSystemQuery(4, 1, [11000,2]); // System query \"Own Duplicate List\" */ executeSystemQuery(master, detail, queryParameters, loadBlobs = false, recordCount = 0) { // @ts-ignore return new QueryObject(this, null, master, detail, queryParameters, loadBlobs, recordCount); } /** * Runs a native (SQL) database query, only if the user has SQL Exec the permissions! * @param {string} sqlQueryText - The SQL query text * @param {array} queryParameters - The query parameters delivered via a JS Array * @param {boolean} [loadBlobs=false] - If true, blob fields (e.g. memo, stream) are returned * @param {number} [recordCount] - Limit the returned records * @returns {DataSetObject} * @example * const appos = crm.executeSqlQuery(\"Select * from ACTIONS where PLANNED=:p1 and DONE=:p2\", [\"1\", \"0\"], true, 2); */ executeSqlQuery(sqlQueryText, queryParameters, loadBlobs = false, recordCount = 0) { // @ts-ignore return new QuerySQLObject(this, sqlQueryText, queryParameters, loadBlobs, recordCount); } /** * Selects records that exactly match certain field values * @param {string} entity - The entity name, e.g. \"Comp\" * @param {array} whereFields - A list of field names to match (used as WHERE criteria), e.g. [\"NAME\", \"OPENED\"] * @param {array} whereValues - A list of values to match, e.g. [\"Efficy\", \"1\"] * @param {string} orderByExpression - SQL sort expression, e.g. \"K_COMPANY desc\" * @returns {DataSetObject} * @example * const morningMeetings = crm.consultManyEx(\"Acti\", [\"PLANNED\", \"D_BEGIN\"], [\"1\", \"2022-03-14 09:00:00\"], \"D_BEGIN\"); */ consultManyEx(entity, whereFields, whereValues, orderByExpression) { return new ConsultManyEx(this, entity, whereFields, whereValues, orderByExpression); } /** * Consult your recent records, optionally extended by additional fields. * @param {string} entity - The entity name, e.g. \"Comp\" * @param {array} [extraFields=[]] - A list of extra fields to consult for each recent entity record, e.g. [\"POSTCODE\", \"CITY\"] * @returns {DataSetObject} * @example * const compRecents = crm.consultRecent(\"Comp\"); * const compRecentsEx = crm.consultRecent(\"Comp\", [\"CITY\", \"COUNTRY\"]); */ consultRecent(entity, extraFields = []) { return new RecentList(this, entity, extraFields); } /** * Consult your favorite records. * @param {string} entity - The entity name, e.g. \"Comp\" * @returns {DataSetObject} * @example * const compFavorites = crm.consultFavorites(\"Comp\"); */ consultFavorites(entity) { return new FavoriteList(this, entity); } /** * Request the accessible categories - for the current user - of the given entity * @param {string} entity - The entity name, e.g. \"Comp\" * @returns {DataSetObject} * @example * const compCategories = crm.getCategoryCollection(\"comp\"); */ getCategoryCollection(entity) { const detail = \"\"; return new CollectionObject(this, entity, detail); } /** * Requests a list of users, groups and resources * @returns {DataSetObject} * @example * const userList = crm.getUserList(); */ getUserList() { return new UserList(this); } /** * Request a list of system settings. Use the Map object to retrieve settings * @returns {ListObject} * @example * const settings = crm.getSystemSettings(); * await crm.executeBatch(); * settings.map.get(\"ShortDateFormat\"); // e.g. \"dd/mm/yyyy\" * settings.map.forEach(console.log); // prints each setting on console */ getSystemSettings() { return new SystemSettings(this); } /** * Requests the current value of a given Efficy setting. * @param {string} module - The name of the setting. * @param {string} name - The name of the module (JSON object) that owns the setting. * @param {boolean} [asString=true] - If true, the settings of type TDateTime will be returned as a string formatted with the ShortDateTime format. If false, it will be returned as a float value. * @returns {StringObject} * @example * const workingPeriodFrom = crm.getSetting(\"user\", \"WorkingPeriodFrom\"); * const workingPeriodFromFloat = crm.getSetting(\"user\", \"WorkingPeriodFrom\", false); * await crm.executeBatch(); * workingPeriodFrom.result; // e.g. \"30/12/1899 08:00\" * workingPeriodFromFloat.result; // e.g. \"0.333333333333333 */ getSetting(module, name, asString = true) { return new SettingObject(this, module, name, asString); } /** * Deletes records * @param {string} entity - The entity name, e.g. \"Comp\" * @param {number|number[]} keys - List of keys */ deleteEntity(entity, keys) { if (!keys || (Array.isArray(keys) &amp;&amp; keys.length === 0)) return; new DeleteEntity(this, entity, keys); } /** * Provides access to the methods of a constructed WsObject * Methods are isolated from RemoteObjects because they contain implicit executeBatch() operations * @type {WsObject} */ get ws() { return new WsObject(this); } /** * Efficy Enterprise constants * @readonly * @enum {object} */ constants = { account_kind: { user: 0, group: 1, resource: 2, team: 3 }, file_type: { embedded: 1, linked: 2, remote: 4, large: 5 }, access_code: { search: 1, read: 2, write: 4, delete: 8, showcontent: 16, addcontent: 32, modifycontent: 64, deletecontent: 128, secure: 256, fullcontrol: 271, securecontent: 512, nocontent: 2048 } } } export default CrmRpc; × Search results Close Efficy Enterprise API for Node.js and browser "},"remote-objects_edit.mjs.html":{"id":"remote-objects_edit.mjs.html","title":"Source: remote-objects/edit.mjs","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Source: remote-objects/edit.mjs import RemoteAPI from '../remote-api.mjs'; import RemoteObject from './remote-object.mjs'; import DataSetList from './dataset/list.mjs'; import AttachmentList from './attachment/list.mjs'; import AttachmentObject from './attachment/type.mjs' import {ParseGentle, ParseHard} from './utils/parsing.mjs'; import DataSetObject from './dataset/dataset-object.mjs'; /** * Constructed class Returned by RemoteObjects.openEditObject * @extends RemoteObject * @property {string} entity - The entity name of the edited record * @property {number} key - The key of the edited record * @property {number} edithandle - The handle of the edit operation * @property {boolean} inserted - True when record is newly inserted in the DB * @property {object} data - The master, categories and detail objects available as properties of data */ class EditObject extends RemoteObject { entity; key; edithandle; data; /** @protected */ commit; /** @protected */ closecontext; /** @protected */ inserted; #masterData; #categories; #details; #otherFuncs; #dataSetList; #attachmentList; #isDirty; /** * Opens an edit context for the record identified by entity and key. * A context remains memory-resident (on the web server) until it is closed. Always match with a closeContext() call to avoid memory consumption. * @param {RemoteAPI} remoteAPI * @param {number} editHandle - Possibility to pass an existing editHandle * @param {string} entity - The entity name, e.g. \"Comp\" * @param {number} [key=0] - The key of the record. Use key = 0 to create a new record */ constructor(remoteAPI, editHandle, entity, key) { super(remoteAPI); this.entity = entity; this.key = ParseGentle.toFloatKey(key) this.#dataSetList = new DataSetList(remoteAPI); this.#attachmentList = new AttachmentList(remoteAPI); this.inserted = (this.key === 0); this.edithandle = editHandle &gt; 0 ? editHandle : null; this.#resetState(); this.#setDirty(); } #resetState() { this.commit = null; this.closecontext = null; this.inserted = false; this.#masterData = {}; this.#categories = {}; this.#details = {}; this.#otherFuncs = []; this.#dataSetList.resetState(); this.#attachmentList.resetState(); this.#isDirty = false; } #setDirty() { if (this.#isDirty) return; this.api.registerObject(this); this.#isDirty = true; } /** * Retrieves a master [DataSet]{@link Dataset.html} from the edit context. * @returns {DataSetObject} */ getMasterDataSet() { this.#setDirty(); return this.#dataSetList.getMasterDataSet(); } /** * Retrieves the [DataSet]{@link Dataset.html} for category categoryName. Can be null when the category is not available to the current user. * @param {string} categoryName - name of the category, e.g. \"DOCU$INVOICING\" * @returns {DataSetObject} */ getCategoryDataSet(categoryName) { this.#setDirty(); return this.#dataSetList.getCategoryDataSet(categoryName); } /** * Retrieves a relation [DataSet]{@link Dataset.html} for the specified detail in the edit context. * @param {string} detail - The detail name, e.g. \"Comp\" * @param {string} [filter=\"\"] - SQL filter expression, e.g. \"COMMENT like '%template%'\" * @param {boolean} [includeBlobContent=false] - If true, blob fields (e.g. memo, stream) are returned * @returns {DataSetObject} */ getDetailDataSet(detail, filter = \"\", includeBlobContent = false) { this.#setDirty(); return this.#dataSetList.getDetailDataSet(detail, filter, includeBlobContent); } /** * Request attachment from FILES table * @param {number} k_file * @param {number} [version=0] * @returns {AttachmentObject} */ getAttachment(k_file, version) { this.#setDirty(); return this.#attachmentList.getAttachment(k_file, version); } /** * Updates the field values of a master data set * @param {string} name * @param {string|number} value */ updateField(name, value) { ParseHard.isFieldValue(value); this.#masterData[name] = value; this.#setDirty(); } /** * Updates the field values of a master data set. * @param {object} fieldsObj - e.g. {\"OPENED\": \"0\"} */ updateFields(fieldsObj) { Object.assign(this.#masterData, ParseGentle.fieldsObj(fieldsObj)); this.#setDirty(); } /** * Updates the value of a field of any type in a category data set * @param {string} categoryName * @param {string} name * @param {string|number} value */ updateCategoryField(categoryName, name, value) { if (typeof categoryName !== \"string\") throw new TypeError(\"EditObject.updateCategoryField::categoryName is not a string\"); ParseHard.isFieldValue(value); this.#categories[categoryName] = this.#categories[categoryName] || {}; this.#categories[categoryName][name] = value; this.#setDirty(); } /** * Updates the value of a field of any type in a category data set * @param {string} categoryName * @param {object} fieldsObj - e.g. {\"OPENED\": \"0\"} */ updateCategoryFields(categoryName, fieldsObj) { if (typeof categoryName !== \"string\") throw new TypeError(\"EditObject.updateCategoryFields::categoryName is not a string\"); this.#categories[categoryName] = this.#categories[categoryName] || {}; Object.assign(this.#categories[categoryName], ParseGentle.fieldsObj(fieldsObj)); this.#setDirty(); } /** * Inserts a detail relation * @param {string} detail - The detail name, e.g. \"Comp\" * @param {number} detailKey - The key of the detail * @param {boolean} [linkMainCompany=false] * @param {boolean} [retrieveName=false] */ insertDetail(detail, detailKey, linkMainCompany = false, retrieveName = false) { if (typeof detail !== \"string\") throw new TypeError(\"EditObject.insertDetail::detail is not a string\"); const obj = { \"@name\": \"insertDetail\", \"detail\": detail, \"detailkey\": detailKey } if (typeof linkMainCompany === \"boolean\" &amp;&amp; linkMainCompany) obj.maincomp = linkMainCompany; if (typeof retrieveName === \"boolean\" &amp;&amp; retrieveName) obj.retrieveName = retrieveName; this.#otherFuncs.push(obj); this.#setDirty(); } /** * Updates field values of a detail relation. When the detail relation doesn't exist, an exception is thrown. * @param {string} detail - The detail name, e.g. \"Comp\" * @param {number|string} detailKey - The key of the detail. If detailKey is 0, the current detail record is used * @param {object} fieldsObj, e.g. {\"OPENED\": \"0\"} */ updateDetail(detail, detailKey, fieldsObj) { if (typeof detail !== \"string\") throw new TypeError(\"EditObject.updateDetail::detail is not a string\"); this.#otherFuncs.push({ \"@name\": \"updateDetail\", \"detail\": detail, \"detailkey\": detailKey, \"@data\": ParseGentle.fieldsObj(fieldsObj) }); this.#setDirty(); } /** * Deletes a detail relation * @param {string} detail - The detail name, e.g. \"Comp\" * @param {number|string} detailKey - The key of the detail */ deleteDetail(detail, detailKey) { if (typeof detail !== \"string\") throw new TypeError(\"EditObject.deleteDetail::detail is not a string\"); this.#otherFuncs.push({ \"@name\": \"deleteDetail\", \"detail\": detail, \"detailkey\": detailKey }); this.#setDirty(); } /** * Clears all relations for the specified detail * @param {string} detail - The detail name, e.g. \"Comp\" */ clearDetail(detail) { if (typeof detail !== \"string\") throw new TypeError(\"EditObject.clearDetail::detail is not a string\"); this.#otherFuncs.push({ \"@name\": \"clearDetail\", \"detail\": detail }); this.#setDirty(); } /** * Activates a category. If the user does not have the appropriate rights on the category, an exception is thrown. * @param {string} categoryName */ activateCategory(categoryName) { if (typeof categoryName !== \"string\") throw new TypeError(\"EditObject.activateCategory::categoryName is not a string\"); this.#otherFuncs.push({ \"@name\": \"activateCategory\", \"category\": categoryName }); this.#setDirty(); } /** * Requests that a unique reference number be generated when committing. * @param {number} id - SYS_REFERENCES.K_REFERENCE */ setReference(id) { if (typeof id !== \"number\") throw new TypeError(\"EditObject.setReference::id is not a number\"); this.#otherFuncs.push({ \"@name\": \"reference\", \"id\": ParseGentle.toFloatKey(id) }); this.#setDirty(); } /** * Sets the user relations. * @param {array} users - The array of user IDs (keys). * @param {boolean} [clear=false] - If true, clears the current user selection. */ setUsers(users, clear = false) { if (!Array.isArray(users)) throw new TypeError(\"EditObject.setUsers::users is not an Array\"); const obj = { \"@name\": \"setusers\", \"users\": users } if (typeof clear === \"boolean\") obj.clear = clear; this.#otherFuncs.push(obj); this.#setDirty(); } /** * Sets the security for a user or group. * @param {number} account - The user or group for which security is added. * @param {number} securityValue - A sum of one or more of the following values: 1 (search), 2 (read), 4 (write), 8 (delete) and 256 (secure). Useful combinations are 7 (read/write), 15 (read/write/delete) and 271 (full control = read/write/delete/secure). */ setUserSecurity(account, securityValue) { if (typeof account !== \"number\") throw new TypeError(\"EditObject.setUserSecurity::account is not a number\"); if (typeof securityValue !== \"number\") throw new TypeError(\"EditObject.setUserSecurity::securityValue is not a number\"); this.#otherFuncs.push({ \"@name\": \"setusersecurity\", \"user\": account, \"security\": securityValue }); this.#setDirty(); } /** * Inserts an file * @param {number} attachedFileType - 1 = embedded, 2 = linked, 4 = remote, 5 = large * @param {string} path - The path of the file that will be saved in the FILES.PATH field. */ insertAttachment(attachedFileType, path) { if (typeof attachedFileType !== \"number\") throw new TypeError(\"EditObject.insertAttachment::attachedFileType is not a number\"); if (typeof path !== \"string\") throw new TypeError(\"EditObject.insertAttachment::path is not a string\"); this.#otherFuncs.push({ \"@name\": \"insertAttachment\", \"type\": attachedFileType, \"path\": path }); this.#setDirty(); } /** * Updates an embedded file * @param {number} key - Leave null or 0 to set the stream of the just inserted Attachment * @param {string} base64String */ updateAttachment(key = 0, base64String) { if (typeof key !== \"number\") throw new TypeError(\"EditObject.updateAttachment::key is not a number\"); if (typeof base64String !== \"string\") throw new TypeError(\"EditObject.updateAttachment::base64String is not a string\"); this.#otherFuncs.push({ \"@name\": \"updateAttachment\", \"key\": key, \"encodingkind\": \"MIME64\", \"@data\": base64String }); this.#setDirty(); } /** * Copies data from an existing record in the database. The same entity as the current is assumed. * The table views within the index range minIndex to maxIndex are copied. By default, all table views are copied. * To copy a single detail, obtain the table view index using IndexFromDetail and use this value as MinIndex and MaxIndex. * @param {number} key - The key of the source record. * @param {number} [minTableView=0] - The index of first table view to be copied. * @param {number} [maxTableView=999] - The index of last table view to be copied. */ copyFromExisting(key, minTableView = 0, maxTableView = 999) { if (typeof key !== \"number\") throw new TypeError(\"EditObject.copyFromExisting::key is not a number\"); if (typeof minTableView !== \"number\") throw new TypeError(\"EditObject.copyFromExisting::minTableView is not a number\"); if (typeof maxTableView !== \"number\") throw new TypeError(\"EditObject.copyFromExisting::maxTableView is not a number\"); this.#otherFuncs.push({ \"@name\": \"copyFromExisting\", \"key\": key, \"mintableview\": minTableView, \"maxtableview\": maxTableView }); this.#setDirty(); } /** * Commits the changes to the database. */ commitChanges() { this.commit = true; this.#setDirty(); } /** * Closes the context and frees the memory on the web server. */ closeContext() { this.closecontext = true; this.#setDirty(); } /** * Commits the changes, releases the record and executes closeContext */ closingCommit() { this.commit = true; this.closecontext = true; this.#setDirty(); } /** @protected */ asJsonRpc() { const requestObject = { \"#id\": this.id, \"@name\": \"edit\", \"@func\": [] }; // lowercase properties are required for the case sensitive JSON RPC [\"entity\", \"key\", \"edithandle\", \"commit\", \"closecontext\"].forEach(property =&gt; { if (this[property] != null) requestObject[property] = this[property]; }); if (typeof this.#details === \"object\" &amp;&amp; Object.keys(this.#details).length &gt; 0) { Object.keys(this.#details).forEach(detail =&gt; { requestObject[\"@func\"].push({ \"@name\": \"detail\", \"detail\": detail }) }) } requestObject[\"@func\"].push(...this.#otherFuncs); // Placed after #otherFuncs, because they could have the activateCategory if (typeof this.#categories === \"object\" &amp;&amp; Object.keys(this.#categories).length &gt; 0) { Object.keys(this.#categories).forEach(categoryName =&gt; { requestObject[\"@func\"].push({ \"@name\": \"update\", \"category\": categoryName, \"@data\": this.#categories[categoryName] }) }) } requestObject[\"@func\"].push(...this.#dataSetList.funcs); requestObject[\"@func\"].push(...this.#attachmentList.funcs); if (typeof this.#masterData === \"object\" &amp;&amp; Object.keys(this.#masterData).length &gt; 0) { requestObject[\"@func\"].push({ \"@name\": \"update\", \"@data\": this.#masterData }) } return requestObject; } /** @protected */ afterExecute() { super.afterExecute(); // lowercase properties are required for the case sensitive JSON RPC [\"entity\", \"key\", \"edithandle\", \"commit\", \"closecontext\"].forEach(property =&gt; { this[property] = this.responseObject[property]; }); this.#dataSetList.setResponseObject(this.responseObject); this.#dataSetList.afterExecute(); this.#dataSetList.setData(this); this.#attachmentList.setResponseObject(this.responseObject); this.#attachmentList.afterExecute(); this.#resetState(); } } export default EditObject; × Search results Close Efficy Enterprise API for Node.js and browser "},"remote-objects_edit-relation.mjs.html":{"id":"remote-objects_edit-relation.mjs.html","title":"Source: remote-objects/edit-relation.mjs","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Source: remote-objects/edit-relation.mjs import RemoteAPI from '../remote-api.mjs'; import RemoteObject from './remote-object.mjs'; import DataSetList from './dataset/list.mjs'; import {ParseGentle, ParseHard} from './utils/parsing.mjs'; import DataSetObject from './dataset/dataset-object.mjs'; /** * Constructed class Returned by RemoteObjects.openEditRelationObject * @extends RemoteObject * @property {string} entity - The entity name * @property {number} key - The key of the entity record * @property {string} detail - The detail name * @property {number} detailkey - The key of the detail record * @property {number} edithandle - The handle of the edit operation * @property {boolean} inserted - True when record is newly inserted in the DB * @property {object} data */ class EditRelationObject extends RemoteObject { entity; detail; key; detailkey; edithandle; data; /** @protected */ commit; /** @protected */ closecontext; /** @protected */ inserted; #masterData; #master1Data; #otherFuncs; #dataSetList; #isDirty; /** * Opens an edit context for a relation. If the relation does not yet exist, it is created. * A context remains memory-resident (on the web server) until it is closed. Always match with a closeContext() call to avoid memory consumption. * @param {RemoteAPI} remoteAPI * @param {number} editHandle - Possibility to pass an existing editHandle * @param {string} entity - The entity name, e.g. \"Comp\" * @param {string} detail - The detail name, e.g. \"Cont\" * @param {number} key - The key of the entity * @param {number} detailKey - The key of the detail * @param {number} [relationId] - The key of the relation if multi-relation is available */ constructor(remoteAPI, editHandle, entity, detail, key, detailKey, relationId) { super(remoteAPI); this.entity = entity; this.detail = detail; this.key = ParseGentle.toFloatKey(key); this.detailkey = ParseGentle.toFloatKey(detailKey); this.relationId = ParseGentle.toFloatKey(relationId); this.#dataSetList = new DataSetList(remoteAPI); this.inserted = (this.key === 0); this.edithandle = editHandle &gt; 0 ? editHandle : null; if (this.relationId != null) { this.detailkey = [this.detailkey, this.relationId].join(\"_\"); } this.#resetState(); this.#setDirty(); } #resetState() { this.commit = null; this.closecontext = null; this.inserted = null; this.#masterData = {}; this.#master1Data = {}; this.#otherFuncs = []; this.#dataSetList.resetState(); this.#isDirty = false; } #setDirty() { if (this.#isDirty) return; this.api.registerObject(this); this.#isDirty = true; } /** * Retrieves a master [DataSet]{@link Dataset.html} from the edit context. * @param {number} [tableView=0] * @returns {DataSetObject} */ getMasterDataSet(tableView = 0) { this.#setDirty(); return this.#dataSetList.getMasterDataSet(tableView); } /** * Updates the field values of a master data set * @param {string} name * @param {string|number} value */ updateField(name, value) { ParseHard.isFieldValue(value); this.#masterData[name] = value; this.#setDirty(); } /** * Updates the field values of a master data set. * @param {object} fieldsObj - e.g. {\"OPENED\": \"0\"} */ updateFields(fieldsObj) { Object.assign(this.#masterData, ParseGentle.fieldsObj(fieldsObj)); this.#setDirty(); } /** * Updates the field values of a reciprocity table view, e.g. CONT_CONT.RELATION of the 2nd record * @param {string} name * @param {string|number} value */ updateReciprocityField(name, value) { ParseHard.isFieldValue(value); this.#master1Data[name] = value; this.#setDirty(); } /** * Updates the field values of a reciprocity table view, e.g. CONT_CONT.RELATION of the 2nd record * @param {object} fieldsObj - e.g. {\"OPENED\": \"0\"} */ updateReciprocityFields(fieldsObj) { Object.assign(this.#master1Data, ParseGentle.fieldsObj(fieldsObj)); this.#setDirty(); } /** * Commits the changes to the database. */ commitChanges() { this.commit = true; this.#setDirty(); } /** * Closes the context and frees the memory on the web server. */ closeContext() { this.closecontext = true; this.#setDirty(); } /** * Commits the changes, releases the record and executes closeContext */ closingCommit() { this.commit = true; this.closecontext = true; this.#setDirty(); } /** @protected */ asJsonRpc() { const requestObject = { \"#id\": this.id, \"@name\": \"edit\", \"@func\": [] }; // lowercase properties are required for the case sensitive JSON RPC [\"entity\", \"detail\", \"key\", \"detailkey\", \"edithandle\", \"commit\", \"closecontext\"].forEach(property =&gt; { if (this[property] != null) requestObject[property] = this[property]; }); requestObject[\"@func\"].push(...this.#otherFuncs); requestObject[\"@func\"].push(...this.#dataSetList.funcs); if (typeof this.#masterData === \"object\" &amp;&amp; Object.keys(this.#masterData).length &gt; 0) { requestObject[\"@func\"].push({ \"@name\": \"update\", \"tableview\": 0, \"@data\": this.#masterData }) } if (typeof this.#master1Data === \"object\" &amp;&amp; Object.keys(this.#master1Data).length &gt; 0) { requestObject[\"@func\"].push({ \"@name\": \"update\", \"tableview\": 1, \"@data\": this.#master1Data }) } return requestObject; } /** @protected */ afterExecute() { super.afterExecute(); // lowercase properties are required for the case sensitive JSON RPC [\"entity\", \"detail\", \"key\", \"detailkey\", \"edithandle\", \"commit\", \"closecontext\"].forEach(property =&gt; { this[property] = this.responseObject[property]; }); this.#dataSetList.setResponseObject(this.responseObject); this.#dataSetList.afterExecute(); this.#dataSetList.setData(this); this.#resetState(); } } export default EditRelationObject; × Search results Close Efficy Enterprise API for Node.js and browser "},"remote-objects_list_list-object.mjs.html":{"id":"remote-objects_list_list-object.mjs.html","title":"Source: remote-objects/list/list-object.mjs","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Source: remote-objects/list/list-object.mjs import RemoteObject from '../remote-object.mjs'; /** * Class uses by operations that return a list * @extends RemoteObject * @property {Map} map - The Map object holds key-value pairs and remembers the original order of the keys, {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map} */ class ListObject extends RemoteObject { map; // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map constructor(remoteAPI) { super(remoteAPI); this.api.registerObject(this); } /** @protected */ afterExecute() { super.afterExecute(); this.items = this.api.findListArray(this.responseObject); // https://stackoverflow.com/questions/26264956/convert-object-array-to-hash-map-indexed-by-an-attribute-value-of-the-object this.map = new Map(this.items.map(item =&gt; [item.split(\"=\")[0], item.split(\"=\")[1]])); } } export default ListObject; × Search results Close Efficy Enterprise API for Node.js and browser "},"remote-objects_base-type_string-object.mjs.html":{"id":"remote-objects_base-type_string-object.mjs.html","title":"Source: remote-objects/base-type/string-object.mjs","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Source: remote-objects/base-type/string-object.mjs import RemoteObject from '../remote-object.mjs'; /** * Class uses by operations that return a string result * @extends RemoteObject * @property {string} result */ class StringObject extends RemoteObject { result; /** @protected */ operationName; constructor(remoteAPI) { super(remoteAPI); this.api.registerObject(this); } /** @protected */ afterExecute() { super.afterExecute(); this.result = this.api.findFunc(this.responseObject, this.operationName)?.[\"#result\"]; } } export default StringObject; × Search results Close Efficy Enterprise API for Node.js and browser "},"ws-objects_ws-object.mjs.html":{"id":"ws-objects_ws-object.mjs.html","title":"Source: ws-objects/ws-object.mjs","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Source: ws-objects/ws-object.mjs import RemoteObject from '../remote-objects/remote-object.mjs'; import EditObject from \"../remote-objects/edit.mjs\"; /** * Class with methods that contain executeBatch commands * @extends RemoteObject */ class WsObject extends RemoteObject { constructor(remoteAPI) { super(remoteAPI); } /** * * @param {EditObject} editObject * @param {string} filter - Server-side SQL filter expression, added as filter property of [TDataSet](https://help.efficy.io/extras/serverjs.html#TDataSet) * @param {boolean} includeBlobContent - On true, returns all blob streams (e.g. attachment, thumb) * @returns {Promise&lt;Array&gt;} * @example * await crm.ws.getFiles(document, `COMMENT like '%.docx'`, false); */ async getFiles(editObject, filter, includeBlobContent) { await this.api.executeBatch(); const dsFiles = editObject.getDetailDataSet(\"file\", filter, includeBlobContent); await this.api.executeBatch(); if (!Array.isArray(dsFiles.items) || dsFiles.items.length === 0) return []; // Sort like in UI, highest/latest K_SORT first const fnSort = (a, b) =&gt; b.K_SORT - a.K_SORT; const sortedFiles = dsFiles.items.sort(fnSort); return sortedFiles; } /** * Instantly delete files, optionally SQL expression filtered * @param {EditObject} editObject * @param {string} [filter=\"\"] - SQL filter expression, e.g. \"COMMENT like '%template%'\" * @example * await crm.ws.deleteFiles(document); * await crm.ws.deleteFiles(document, `COMMENT like '%template%'`); */ async deleteFiles(editObject, filter) { const files = await this.getFiles(editObject, filter, false); files.forEach(file =&gt; { editObject.deleteDetail(\"file\", file.K_FILE + \"_\" + file.VERSION); }) await this.api.executeBatch(); } /** * Instantly cleanup files, but keep top X, optionally SQL expression filtered * @param {EditObject} editObject * @param {string} [filter=\"\"] - SQL filter expression, e.g. \"COMMENT like '%template%'\" * @param {number} [keepTopX=7] - Keep only the top X files, sorted highest/latest K_SORT first * @example * await crm.ws.cleanupFiles(document, \"\", 7); * await crm.ws.cleanupFiles(document, `COMMENT like '%template%'`, 0); */ async cleanupFiles(editObject, filter, keepTopX = 7) { const files = await this.getFiles(editObject, filter, false); files.filter((file, index) =&gt; index &gt;= keepTopX).forEach(file =&gt; { editObject.deleteDetail(\"file\", file.K_FILE + \"_\" + file.VERSION); }) await this.api.executeBatch(); } } export default WsObject; × Search results Close Efficy Enterprise API for Node.js and browser "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Classes Classes AttachmentObject CollectionObject ConsultObject CrmEnv CrmRpc DataSetObject DeleteEntity EditObject EditRelationObject ListObject StringObject WsObject × Search results Close Efficy Enterprise API for Node.js and browser "},"tutorials.list.html":{"id":"tutorials.list.html","title":"Tutorials","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Tutorials Classes AttachmentObject CollectionObject ConsultObject CrmEnv CrmRpc DataSetObject DeleteEntity EditObject EditRelationObject ListObject StringObject WsObject × Search results Close Efficy Enterprise API for Node.js and browser "},"index.html":{"id":"index.html","title":"Index","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Efficy Enterprise API Introduction The Efficy Enterprise API is developed for server-side usage in a Node.js environment (e.g. for integrations) and also bundled for usage inside an Efficy browser session for client-side JSON RPC requests. Node.js instructions In your Node.js project, first install the efficy-enterprise-api npm package. powershell npm i efficy-enterprise-api import { CrmEnv, CrmRpc} from \"efficy-enterprise-api\"; const crmEnv = new CrmEnv({ \"url\": \"https://mycompany.efficy.cloud/\", \"apiKey\": \"{Create API key in Designer}\" }); const crm = new CrmRpc(crmEnv); // See CrmEnv class const compSearch = crm.search(\"comp\", \"SEARCHFAST\", \"Efficy\"); await crm.executeBatch(); // Debug output compSearch.items; // An array of row items Efficy in browser instructions Consider reading this Efficy Project Guide about using the Efficy Enterprise API - for browser Switch and use the efficy-enterprise-api-browser npm package. powershell npm i efficy-enterprise-api-browser Use ES import and not AMD RequireJs, to benefit from the jsDoc instructions and intellisense in supporting IDE's such as Visual Studio Code. async function editNewDocu() { const {CrmRpc} = await import('../../../node_modules/efficy-enterprise-api-browser/es.js'); const crm = new CrmRpc(); // Get all products of the Opportunity, using the consultHandle available in the page Model object. // This is faster then crm.openConsultObject(\"Oppo\", Model(\"key\")); const opportunity = crm.getConsultObject(Model(\"consultHandle\"), \"Oppo\"); const oppoProds = opportunity.getDetailDataSet(\"Prod\"); await crm.executeBatch(); // Create a new Document const invoiceDocu = crm.openEditObject(\"docu\", 0); // Set master and category fields invoiceDocu.updateFields({ \"NAME\": \"Non committed invoice\" }); invoiceDocu.activateCategory(\"DOCU$INVOICING\"); invoiceDocu.updateCategoryFields(\"DOCU$INVOICING\", { \"D_INVOICE\": moment().format(Model('shortDateFormat')), // Now \"TYPE\": 1 // Manual invoice }); // Link the main details of the Opportunity invoiceDocu.insertDetail(\"Oppo\", Model(\"key\")); invoiceDocu.insertDetail(\"Comp\", Model(\"K_COMPANY\")); invoiceDocu.insertDetail(\"Cont\", Model(\"K_CONTACT\")); // Insert each product from the Opportunity on the invoice oppoProds.items.forEach(oppoProd =&gt; { invoiceDocu.insertDetail(\"Prod\", oppoProd[\"K_PRODUCT\"]); invoiceDocu.updateDetail(\"Prod\", 0, { \"QUANTITY\": oppoProd[\"QUANTITY\"], \"PRICE\": oppoProd[\"PRICE\"], \"DISCOUNT\": oppoProd[\"DISCOUNT\"], \"VAT\": oppoProd[\"VAT\"], \"TOTAL\": oppoProd[\"TOTAL\"] }); }) // Note that we do not commit! All queued operations are now sent to the server await crm.executeBatch(); // With the returned editHandle, the edit dialog is opened! var url = `edit?page=edit/edit&amp;entity=docu&amp;action=refreshOpener&amp;edithandle=${invoiceDocu.edithandle}`, options = {url: url, width: 640, height: 640, name: 'edit_docu'}; WindowManager.open('dialog', options); } Intellisense Use ES import and not AMD RequireJs, to benefit from the jsDoc instructions and intellisense in supporting IDE's such as Visual Studio Code. Methods on the general CrmRpc object Methods from EditObject Get started Learn the available public CrmRpc methods and properties Tutorials How to configure your CRM environment How to insert a document with relations, categories and reference How to execute Queries and Searches Contribute The Efficy Enterprise API is developed with Visual Studio Code and Node.js v16.13.2. Follow these contribution instructions to configure your development environment. The sources are available on github.com/Pauwris/efficy-enterprise-api × Search results Close Efficy Enterprise API for Node.js and browser "},"AttachmentObject.html":{"id":"AttachmentObject.html","title":"Class: AttachmentObject","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Class: AttachmentObject AttachmentObject Class representing a remotely fetched Attachment new AttachmentObject() Source: remote-objects/attachment/type.mjs, line 4 Members base64Stream :string get the base64 encoded attachment stream Type: string Source: remote-objects/attachment/type.mjs, line 20 × Search results Close Efficy Enterprise API for Node.js and browser "},"CollectionObject.html":{"id":"CollectionObject.html","title":"Class: CollectionObject","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Class: CollectionObject CollectionObject Class returned by methods such as getCategoryCollection new CollectionObject() Source: remote-objects/api.mjs, line 8 Extends DataSetObject Classes CollectionObject Members &lt;protected&gt; dataSetName Inherited From: DataSetObject#dataSetName Overrides: DataSetObject#dataSetName Source: remote-objects/dataset/dataset-object.mjs, line 18 item :array When exists, the first item of the items array, else null Type: array Inherited From: DataSetObject#item Overrides: DataSetObject#item Source: remote-objects/dataset/dataset-object.mjs, line 42 items :array The to array converted dataset Type: array Inherited From: DataSetObject#items Overrides: DataSetObject#items Source: remote-objects/dataset/dataset-object.mjs, line 34 Methods &lt;protected&gt; afterExecute() Inherited From: DataSetObject#afterExecute Overrides: DataSetObject#afterExecute Source: remote-objects/dataset/dataset-object.mjs, line 21 × Search results Close Efficy Enterprise API for Node.js and browser "},"ConsultObject.html":{"id":"ConsultObject.html","title":"Class: ConsultObject","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Class: ConsultObject ConsultObject Class returned by openConsultObject new ConsultObject(remoteAPI, entity, key [, consultHandle]) Opens an consult context for the record identified by entity and key. A context remains memory-resident (on the web server) until it is closed. Always match with a closeContext() call to avoid memory consumption. Parameters: Name Type Argument Description remoteAPI RemoteAPI entity string The entity name of the consulted record, e.g. \"Comp\" key number The key of the consulted record consultHandle number &lt;optional&gt; Possibility to pass an existing consultHandle Properties: Name Type Description entity string The entity name of the consulted record key number The key of the consulted record consulthandle number The handle of the consult operation data object The master, categories and detail objects available as properties of data Source: remote-objects/consult.mjs, line 15 Extends RemoteObject Members &lt;protected&gt; closecontext Source: remote-objects/consult.mjs, line 22 Methods &lt;protected&gt; afterExecute() Source: remote-objects/consult.mjs, line 119 &lt;protected&gt; asJsonRpc() Source: remote-objects/consult.mjs, line 100 closeContext() Closes the context and frees the memory on the web server. Source: remote-objects/consult.mjs, line 94 getCategoryDataSet(categoryName) Retrieves the DataSet for category categoryName. Can be null when the category is not available to the current user. Parameters: Name Type Description categoryName string name of the category, e.g. \"DOCU$INVOICING\" Source: remote-objects/consult.mjs, line 74 Returns: Type DataSetObject getDetailDataSet(detail [, filter] [, includeBlobContent]) Retrieves a relation DataSet for the specified detail in the edit context. Parameters: Name Type Argument Default Description detail string The detail name, e.g. \"Comp\" filter string &lt;optional&gt; \"\" SQL filter expression, e.g. \"COMMENT like '%template%'\" includeBlobContent boolean &lt;optional&gt; false If true, blob fields (e.g. memo, stream) are returned Source: remote-objects/consult.mjs, line 86 Returns: Type DataSetObject getMasterDataSet() Retrieves a master DatasetObject from the consult context. Source: remote-objects/consult.mjs, line 64 Returns: Type DataSetObject × Search results Close Efficy Enterprise API for Node.js and browser "},"CrmEnv.html":{"id":"CrmEnv.html","title":"Class: CrmEnv","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Class: CrmEnv CrmEnv Class to define the parameters of the Efficy Enterprise server new CrmEnv( [env]) Create a Crm Environment. Set null when executed from browser Parameters: Name Type Argument Description env Object &lt;optional&gt; The definition object of the targeted CRM environment Properties Name Type Argument Default Description url string &lt;optional&gt; \"\" The URL of Efficy Enterprise, e.g. https://mycompany.efficy.cloud/. Set null when executed from browser customer string &lt;optional&gt; \"\" The optional customer profile name logOff boolean &lt;optional&gt; false if true, logoff the session after the next executeBatch(); apiKey string &lt;optional&gt; \"\" The API Key, if user and password are not used user string &lt;optional&gt; \"\" The user credential pwd string &lt;optional&gt; \"\" The password credential cookies array &lt;optional&gt; [] Optional cookie setting Source: crm-env.mjs, line 4 Tutorials: CRM Environment Example new CrmEnv({ \"url\": \"https://mycompany.efficy.cloud/\", \"apiKey\": \"86E353284C0C4A848F7ADEA13589C8B6\" }); Members cookieHeader :string Returns the request header \"cookie\", e.g. 'EfficySession=3B826396-22AE9698' Type: string Source: crm-env.mjs, line 91 isEfficy :boolean Returns true if this code runs on the browser Type: boolean Source: crm-env.mjs, line 83 isNode :boolean Returns true if this code runs in node.js Type: boolean Source: crm-env.mjs, line 75 sessionId :string Returns the session ID, e.g. '3B826396-22AE9698' Type: string Source: crm-env.mjs, line 106 shortSessionId :string Returns the first part of the session ID, e.g. '3B826396' Type: string Source: crm-env.mjs, line 114 Methods setEnv(env) Update the Crm Environment set by the constructor Parameters: Name Type Description env Object The definition object of the targeted CRM environment Properties Name Type Argument Default Description url string &lt;optional&gt; \"\" The URL of Efficy Enterprise, e.g. https://mycompany.efficy.cloud/. Leave empty when executed from browser customer string &lt;optional&gt; \"\" The optional customer profile name logOff boolean &lt;optional&gt; false if true, logoff the session after the next executeBatch(); apiKey string &lt;optional&gt; \"\" The API Key, if user and password are not used user string &lt;optional&gt; \"\" The user credential pwd string &lt;optional&gt; \"\" The password credential cookies array &lt;optional&gt; [] Optional cookie setting Source: crm-env.mjs, line 50 × Search results Close Efficy Enterprise API for Node.js and browser "},"CrmRpc.html":{"id":"CrmRpc.html","title":"Class: CrmRpc","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Class: CrmRpc CrmRpc Class to create Remote Objects new CrmRpc( [crmEnv] [, logFunction] [, threadId]) Construct a CrmRpc object Parameters: Name Type Argument Description crmEnv CrmEnv &lt;optional&gt; When empty, uses the Efficy context of the browser logFunction function &lt;optional&gt; Your (custom) log function to call for requests and responses, e.g. console.log threadId number &lt;optional&gt; Unique thread ID for logging purposes Source: crm-rpc.mjs, line 30 Example function logger(msg, reqLog) { console.log(msg); } const crm = new CrmRpc(crmEnv, logger); Extends RemoteAPI Members &lt;readonly&gt; constants :object Efficy Enterprise constants Type: object Source: crm-rpc.mjs, line 431 currentDatabaseAlias Retrieves the alias (name) of the currently connected database Source: crm-rpc.mjs, line 64 currentDatabaseTimezone Retrieves the current database timezone Source: crm-rpc.mjs, line 72 currentLicenseName Retrieves the current license name Source: crm-rpc.mjs, line 80 currentUserCode Retrieves the current user code, e.g. \"CRM01\" Source: crm-rpc.mjs, line 112 currentUserFullName Retrieves the current user full name Source: crm-rpc.mjs, line 88 currentUserGroups Retrieves the group memberships of the current user as semicolon separated string list, e.g. \"1;28;292;936\" Source: crm-rpc.mjs, line 96 currentUserId Retrieves the current user key, e.g. \"4\" Source: crm-rpc.mjs, line 104 currentUserTimezone Retrieves the current user timezone Source: crm-rpc.mjs, line 120 ws :WsObject Provides access to the methods of a constructed WsObject Methods are isolated from RemoteObjects because they contain implicit executeBatch() operations Type: WsObject Source: crm-rpc.mjs, line 422 Methods consultFavorites(entity) Consult your favorite records. Parameters: Name Type Description entity string The entity name, e.g. \"Comp\" Source: crm-rpc.mjs, line 349 Returns: Type DataSetObject Example const compFavorites = crm.consultFavorites(\"Comp\"); consultManyEx(entity, whereFields, whereValues, orderByExpression) Selects records that exactly match certain field values Parameters: Name Type Description entity string The entity name, e.g. \"Comp\" whereFields array A list of field names to match (used as WHERE criteria), e.g. [\"NAME\", \"OPENED\"] whereValues array A list of values to match, e.g. [\"Efficy\", \"1\"] orderByExpression string SQL sort expression, e.g. \"K_COMPANY desc\" Source: crm-rpc.mjs, line 325 Returns: Type DataSetObject Example const morningMeetings = crm.consultManyEx(\"Acti\", [\"PLANNED\", \"D_BEGIN\"], [\"1\", \"2022-03-14 09:00:00\"], \"D_BEGIN\"); consultRecent(entity [, extraFields]) Consult your recent records, optionally extended by additional fields. Parameters: Name Type Argument Default Description entity string The entity name, e.g. \"Comp\" extraFields array &lt;optional&gt; [] A list of extra fields to consult for each recent entity record, e.g. [\"POSTCODE\", \"CITY\"] Source: crm-rpc.mjs, line 338 Returns: Type DataSetObject Example const compRecents = crm.consultRecent(\"Comp\"); const compRecentsEx = crm.consultRecent(\"Comp\", [\"CITY\", \"COUNTRY\"]); deleteEntity(entity, keys) Deletes records Parameters: Name Type Description entity string The entity name, e.g. \"Comp\" keys number | Array.&lt;number&gt; List of keys Source: crm-rpc.mjs, line 412 &lt;async&gt; executeBatch() Execute all assembled and queued RPC operations Source: crm-rpc.mjs, line 50 executeDatabaseQuery(idQuery [, queryParameters] [, loadBlobs] [, recordCount]) Executes a database query stored in QUERIES Parameters: Name Type Argument Default Description idQuery number queryParameters array &lt;optional&gt; The query parameters delivered via a JS Array loadBlobs boolean &lt;optional&gt; false If true, blob fields (e.g. memo, stream) are returned recordCount number &lt;optional&gt; 0 If 0, return all records Source: crm-rpc.mjs, line 280 Returns: Type DataSetObject Example const tags = crm.executeDatabaseQuery(99990034); // Query \"Standard: Top company tags\" executeSqlQuery(sqlQueryText, queryParameters [, loadBlobs] [, recordCount]) Runs a native (SQL) database query, only if the user has SQL Exec the permissions! Parameters: Name Type Argument Default Description sqlQueryText string The SQL query text queryParameters array The query parameters delivered via a JS Array loadBlobs boolean &lt;optional&gt; false If true, blob fields (e.g. memo, stream) are returned recordCount number &lt;optional&gt; 0 Limit the returned records Source: crm-rpc.mjs, line 310 Returns: Type DataSetObject Example const appos = crm.executeSqlQuery(\"Select * from ACTIONS where PLANNED=:p1 and DONE=:p2\", [\"1\", \"0\"], true, 2); executeSystemQuery(master, detail, queryParameters [, loadBlobs] [, recordCount]) Executes a system database query stored in SYS_QUERIES Parameters: Name Type Argument Default Description master number detail number queryParameters array The query parameters delivered via a JS Array loadBlobs boolean &lt;optional&gt; false If true, blob fields (e.g. memo, stream) are returned recordCount number &lt;optional&gt; 0 If 0, return all records Source: crm-rpc.mjs, line 295 Returns: Type DataSetObject Example const contDupls = crm.executeSystemQuery(4, 1, [11000,2]); // System query \"Own Duplicate List\" getCategoryCollection(entity) Request the accessible categories - for the current user - of the given entity Parameters: Name Type Description entity string The entity name, e.g. \"Comp\" Source: crm-rpc.mjs, line 360 Returns: Type DataSetObject Example const compCategories = crm.getCategoryCollection(\"comp\"); getConsultObject(consultHandle, entity) Create and return an ConsultObject based on an existing consultHandle Parameters: Name Type Description consultHandle number entity string Weird, but the RPC interface requires the entity of the consultHandle! Source: crm-rpc.mjs, line 149 getEditObject(editHandle) Create and return an EditObject based on an existing editHandle Parameters: Name Type Description editHandle number Source: crm-rpc.mjs, line 219 getEditRelationObject(editHandle) Create and return an EditObject based on an existing editHandle Parameters: Name Type Description editHandle number Source: crm-rpc.mjs, line 227 getSetting(module, name [, asString]) Requests the current value of a given Efficy setting. Parameters: Name Type Argument Default Description module string The name of the setting. name string The name of the module (JSON object) that owns the setting. asString boolean &lt;optional&gt; true If true, the settings of type TDateTime will be returned as a string formatted with the ShortDateTime format. If false, it will be returned as a float value. Source: crm-rpc.mjs, line 401 Returns: Type StringObject Example const workingPeriodFrom = crm.getSetting(\"user\", \"WorkingPeriodFrom\"); const workingPeriodFromFloat = crm.getSetting(\"user\", \"WorkingPeriodFrom\", false); await crm.executeBatch(); workingPeriodFrom.result; // e.g. \"30/12/1899 08:00\" workingPeriodFromFloat.result; // e.g. \"0.333333333333333 getSystemSettings() Request a list of system settings. Use the Map object to retrieve settings Source: crm-rpc.mjs, line 384 Returns: Type ListObject Example const settings = crm.getSystemSettings(); await crm.executeBatch(); settings.map.get(\"ShortDateFormat\"); // e.g. \"dd/mm/yyyy\" settings.map.forEach(console.log); // prints each setting on console getUserList() Requests a list of users, groups and resources Source: crm-rpc.mjs, line 371 Returns: Type DataSetObject Example const userList = crm.getUserList(); logoff() Logoff the remote session, not possible when crmEnv.isEfficy === true Source: crm-rpc.mjs, line 56 openConsultObject(entity, key) Opens a consult context for the record identified by entity and key. A context remains memory-resident (on the web server) until it is closed. Always match with a closeContext() call to avoid memory consumption. Parameters: Name Type Description entity string The entity name, e.g. \"Comp\" key number The key of the record. Use key = 0 to create a new record. Source: crm-rpc.mjs, line 140 Returns: Type ConsultObject Example const comp = crm.openConsultObject(\"comp\", 2); const dsComp = comp.getMasterDataSet(); const dsCompAddress = comp.getCategoryDataSet(\"COMP$ADDRESS\"); const linkedContacts = comp.getDetailDataSet(\"cont\"); await crm.executeBatch(); const companyNames = [comp.data.master.NAME, comp.data.category[\"COMP$ADDRESS\"].NAME]; comp.closeContext(); await crm.executeBatch(); openEditObject(entity [, key]) Opens an edit context for the record identified by entity and key. A context remains memory-resident (on the web server) until it is closed. Always match with a closeContext() call to avoid memory consumption. Parameters: Name Type Argument Default Description entity string The entity name, e.g. \"Comp\" key number &lt;optional&gt; 0 The key of the record. Use key = 0 to create a new record. Source: crm-rpc.mjs, line 185 Returns: Type EditObject Example const docu = crm.openEditObject(\"docu\", 0); docu.updateField(\"NAME\", \"Jan\"); docu.insertDetail(\"Comp\", 2); docu.insertDetail(\"Cont\", 44395, true, true); docu.commitChanges(); docu.activateCategory(\"DOCU$INVOICING\"); docu.updateCategoryFields(\"DOCU$INVOICING\", { \"D_INVOICE\":\"2021-01-08T00:00:00\", \"COMMUNICATION\": \"Hello World!\" }); docu.updateCategoryField(\"DOCU$INVOICING\", \"PRE_PAID\", 123.456) docu.clearDetail(\"Comp\"); docu.insertDetail(\"Comp\", 4); docu.insertDetail(\"Cont\", 50512, false); docu.insertDetail(\"Prod\", 4); docu.updateDetail(\"Prod\", 0, { QUANTITY: 5 }); docu.setUsers([169, 170], true); docu.setUserSecurity(99999002, 271); docu.setReference(99999001); docu.commitChanges(); docu.closeContext(); await crm.executeBatch(); openEditRelationObject(entity, detail, key, detailKey [, relationId]) Opens an edit context for a relation. If the relation does not yet exist, it is created. A context remains memory-resident (on the web server) until it is closed. Always match with a closeContext() call to avoid memory consumption. Parameters: Name Type Argument Description entity string The entity name, e.g. \"Comp\" detail string The detail name, e.g. \"Cont\" key number The key of the entity detailKey number The key of the detail relationId number &lt;optional&gt; The key of the relation if multi-relation is available Source: crm-rpc.mjs, line 211 Returns: Type EditRelationObject Example const contCont = crm.openEditRelationObject(\"cont\", \"cont\", 5, 6); contCont.updateField(\"RELATION\", 1); contCont.updateReciprocityField(\"RELATION\", 2); contCont.commitChanges(); const dsContCont = contCont.getMasterDataSet(); const dsContCont1 = contCont.getMasterDataSet(1); await crm.executeBatch(); console.log(dsContCont.item[\"R_RELATION\"]); console.log(dsContCont1.item[\"R_RELATION\"]); contCont.closingCommit(); await crm.executeBatch(); search(entity, method, value [, own] [, contains] [, opened]) Performs a search on the database and returns the data set with search results. Parameters: Name Type Argument Default Description entity string The entity name, e.g. \"Comp\" method string The field to be searched. Special values SEARCHFAST, SEARCHFULL, SEARCHTEXT, SEARCHFILENAME, SEARCHFILE correspond to the search options in the web application user interface value string The value to search own boolean &lt;optional&gt; false If true, search own records only. contains boolean &lt;optional&gt; true If true, allow matches on part of field opened boolean &lt;optional&gt; true If true, search for opened or active records only Source: crm-rpc.mjs, line 243 Returns: Type DataSetObject Example const compSearch = crm.search(\"comp\", \"SEARCHFAST\", \"Efficy\"); searchContactsByEmail(recipients) Returns all the Contacts having one of the e-mail provided in their e-mail fields (or in the Cont_Comp relation). Parameters: Name Type Description recipients Array.&lt;string&gt; The list of email addresses Source: crm-rpc.mjs, line 254 Returns: Type DataSetObject Example const contactsByEmail = crm.searchContactsByEmail([\"john.doe@efficy.com\", \"john.doe@outlook.com\"]); searchContactsByPhone(phoneNumber) Returns all the first Contacts having a match with the provided (formatted) phone number Parameters: Name Type Description phoneNumber string The phone number, doesn't have to be stripped from formatting Source: crm-rpc.mjs, line 266 Returns: Type DataSetObject Example const contactsByPhone = crm.searchContactsByPhone(\"+32 474 00 00 00\"); × Search results Close Efficy Enterprise API for Node.js and browser "},"DataSetObject.html":{"id":"DataSetObject.html","title":"Class: DataSetObject","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Class: DataSetObject DataSetObject Represents a remotely fetched Efficy DataSet transformed as an array of row items new DataSetObject() Source: remote-objects/dataset/dataset-object.mjs, line 8 Extends RemoteObject Members &lt;protected&gt; dataSetName Source: remote-objects/dataset/dataset-object.mjs, line 18 item :array When exists, the first item of the items array, else null Type: array Source: remote-objects/dataset/dataset-object.mjs, line 42 items :array The to array converted dataset Type: array Source: remote-objects/dataset/dataset-object.mjs, line 34 Methods &lt;protected&gt; afterExecute() Source: remote-objects/dataset/dataset-object.mjs, line 21 × Search results Close Efficy Enterprise API for Node.js and browser "},"DeleteEntity.html":{"id":"DeleteEntity.html","title":"Class: DeleteEntity","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Class: DeleteEntity DeleteEntity Class returned by methods such as deleteEntity new DeleteEntity() Source: remote-objects/api.mjs, line 38 Extends RemoteObject Classes DeleteEntity × Search results Close Efficy Enterprise API for Node.js and browser "},"EditObject.html":{"id":"EditObject.html","title":"Class: EditObject","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Class: EditObject EditObject Constructed class Returned by RemoteObjects.openEditObject new EditObject(remoteAPI, editHandle, entity [, key]) Opens an edit context for the record identified by entity and key. A context remains memory-resident (on the web server) until it is closed. Always match with a closeContext() call to avoid memory consumption. Parameters: Name Type Argument Default Description remoteAPI RemoteAPI editHandle number Possibility to pass an existing editHandle entity string The entity name, e.g. \"Comp\" key number &lt;optional&gt; 0 The key of the record. Use key = 0 to create a new record Properties: Name Type Description entity string The entity name of the edited record key number The key of the edited record edithandle number The handle of the edit operation inserted boolean True when record is newly inserted in the DB data object The master, categories and detail objects available as properties of data Source: remote-objects/edit.mjs, line 18 Extends RemoteObject Members &lt;protected&gt; closecontext Source: remote-objects/edit.mjs, line 27 &lt;protected&gt; commit Source: remote-objects/edit.mjs, line 25 &lt;protected&gt; inserted Source: remote-objects/edit.mjs, line 29 Methods activateCategory(categoryName) Activates a category. If the user does not have the appropriate rights on the category, an exception is thrown. Parameters: Name Type Description categoryName string Source: remote-objects/edit.mjs, line 244 &lt;protected&gt; afterExecute() Source: remote-objects/edit.mjs, line 434 &lt;protected&gt; asJsonRpc() Source: remote-objects/edit.mjs, line 386 clearDetail(detail) Clears all relations for the specified detail Parameters: Name Type Description detail string The detail name, e.g. \"Comp\" Source: remote-objects/edit.mjs, line 230 closeContext() Closes the context and frees the memory on the web server. Source: remote-objects/edit.mjs, line 371 closingCommit() Commits the changes, releases the record and executes closeContext Source: remote-objects/edit.mjs, line 379 commitChanges() Commits the changes to the database. Source: remote-objects/edit.mjs, line 363 copyFromExisting(key [, minTableView] [, maxTableView]) Copies data from an existing record in the database. The same entity as the current is assumed. The table views within the index range minIndex to maxIndex are copied. By default, all table views are copied. To copy a single detail, obtain the table view index using IndexFromDetail and use this value as MinIndex and MaxIndex. Parameters: Name Type Argument Default Description key number The key of the source record. minTableView number &lt;optional&gt; 0 The index of first table view to be copied. maxTableView number &lt;optional&gt; 999 The index of last table view to be copied. Source: remote-objects/edit.mjs, line 346 deleteDetail(detail, detailKey) Deletes a detail relation Parameters: Name Type Description detail string The detail name, e.g. \"Comp\" detailKey number | string The key of the detail Source: remote-objects/edit.mjs, line 215 getAttachment(k_file [, version]) Request attachment from FILES table Parameters: Name Type Argument Default Description k_file number version number &lt;optional&gt; 0 Source: remote-objects/edit.mjs, line 118 Returns: Type AttachmentObject getCategoryDataSet(categoryName) Retrieves the DataSet for category categoryName. Can be null when the category is not available to the current user. Parameters: Name Type Description categoryName string name of the category, e.g. \"DOCU$INVOICING\" Source: remote-objects/edit.mjs, line 95 Returns: Type DataSetObject getDetailDataSet(detail [, filter] [, includeBlobContent]) Retrieves a relation DataSet for the specified detail in the edit context. Parameters: Name Type Argument Default Description detail string The detail name, e.g. \"Comp\" filter string &lt;optional&gt; \"\" SQL filter expression, e.g. \"COMMENT like '%template%'\" includeBlobContent boolean &lt;optional&gt; false If true, blob fields (e.g. memo, stream) are returned Source: remote-objects/edit.mjs, line 107 Returns: Type DataSetObject getMasterDataSet() Retrieves a master DataSet from the edit context. Source: remote-objects/edit.mjs, line 85 Returns: Type DataSetObject insertAttachment(attachedFileType, path) Inserts an file Parameters: Name Type Description attachedFileType number 1 = embedded, 2 = linked, 4 = remote, 5 = large path string The path of the file that will be saved in the FILES.PATH field. Source: remote-objects/edit.mjs, line 308 insertDetail(detail, detailKey [, linkMainCompany] [, retrieveName]) Inserts a detail relation Parameters: Name Type Argument Default Description detail string The detail name, e.g. \"Comp\" detailKey number The key of the detail linkMainCompany boolean &lt;optional&gt; false retrieveName boolean &lt;optional&gt; false Source: remote-objects/edit.mjs, line 177 setReference(id) Requests that a unique reference number be generated when committing. Parameters: Name Type Description id number SYS_REFERENCES.K_REFERENCE Source: remote-objects/edit.mjs, line 258 setUsers(users [, clear]) Sets the user relations. Parameters: Name Type Argument Default Description users array The array of user IDs (keys). clear boolean &lt;optional&gt; false If true, clears the current user selection. Source: remote-objects/edit.mjs, line 273 setUserSecurity(account, securityValue) Sets the security for a user or group. Parameters: Name Type Description account number The user or group for which security is added. securityValue number A sum of one or more of the following values: 1 (search), 2 (read), 4 (write), 8 (delete) and 256 (secure). Useful combinations are 7 (read/write), 15 (read/write/delete) and 271 (full control = read/write/delete/secure). Source: remote-objects/edit.mjs, line 291 updateAttachment(key, base64String) Updates an embedded file Parameters: Name Type Default Description key number 0 Leave null or 0 to set the stream of the just inserted Attachment base64String string Source: remote-objects/edit.mjs, line 325 updateCategoryField(categoryName, name, value) Updates the value of a field of any type in a category data set Parameters: Name Type Description categoryName string name string value string | number Source: remote-objects/edit.mjs, line 148 updateCategoryFields(categoryName, fieldsObj) Updates the value of a field of any type in a category data set Parameters: Name Type Description categoryName string fieldsObj object e.g. {\"OPENED\": \"0\"} Source: remote-objects/edit.mjs, line 162 updateDetail(detail, detailKey, fieldsObj,) Updates field values of a detail relation. When the detail relation doesn't exist, an exception is thrown. Parameters: Name Type Description detail string The detail name, e.g. \"Comp\" detailKey number | string The key of the detail. If detailKey is 0, the current detail record is used fieldsObj, object e.g. {\"OPENED\": \"0\"} Source: remote-objects/edit.mjs, line 198 updateField(name, value) Updates the field values of a master data set Parameters: Name Type Description name string value string | number Source: remote-objects/edit.mjs, line 128 updateFields(fieldsObj) Updates the field values of a master data set. Parameters: Name Type Description fieldsObj object e.g. {\"OPENED\": \"0\"} Source: remote-objects/edit.mjs, line 137 × Search results Close Efficy Enterprise API for Node.js and browser "},"EditRelationObject.html":{"id":"EditRelationObject.html","title":"Class: EditRelationObject","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Class: EditRelationObject EditRelationObject Constructed class Returned by RemoteObjects.openEditRelationObject new EditRelationObject(remoteAPI, editHandle, entity, detail, key, detailKey [, relationId]) Opens an edit context for a relation. If the relation does not yet exist, it is created. A context remains memory-resident (on the web server) until it is closed. Always match with a closeContext() call to avoid memory consumption. Parameters: Name Type Argument Description remoteAPI RemoteAPI editHandle number Possibility to pass an existing editHandle entity string The entity name, e.g. \"Comp\" detail string The detail name, e.g. \"Cont\" key number The key of the entity detailKey number The key of the detail relationId number &lt;optional&gt; The key of the relation if multi-relation is available Properties: Name Type Description entity string The entity name key number The key of the entity record detail string The detail name detailkey number The key of the detail record edithandle number The handle of the edit operation inserted boolean True when record is newly inserted in the DB data object Source: remote-objects/edit-relation.mjs, line 18 Extends RemoteObject Members &lt;protected&gt; closecontext Source: remote-objects/edit-relation.mjs, line 29 &lt;protected&gt; commit Source: remote-objects/edit-relation.mjs, line 27 &lt;protected&gt; inserted Source: remote-objects/edit-relation.mjs, line 31 Methods &lt;protected&gt; afterExecute() Source: remote-objects/edit-relation.mjs, line 197 &lt;protected&gt; asJsonRpc() Source: remote-objects/edit-relation.mjs, line 162 closeContext() Closes the context and frees the memory on the web server. Source: remote-objects/edit-relation.mjs, line 147 closingCommit() Commits the changes, releases the record and executes closeContext Source: remote-objects/edit-relation.mjs, line 155 commitChanges() Commits the changes to the database. Source: remote-objects/edit-relation.mjs, line 139 getMasterDataSet( [tableView]) Retrieves a master DataSet from the edit context. Parameters: Name Type Argument Default Description tableView number &lt;optional&gt; 0 Source: remote-objects/edit-relation.mjs, line 93 Returns: Type DataSetObject updateField(name, value) Updates the field values of a master data set Parameters: Name Type Description name string value string | number Source: remote-objects/edit-relation.mjs, line 103 updateFields(fieldsObj) Updates the field values of a master data set. Parameters: Name Type Description fieldsObj object e.g. {\"OPENED\": \"0\"} Source: remote-objects/edit-relation.mjs, line 112 updateReciprocityField(name, value) Updates the field values of a reciprocity table view, e.g. CONT_CONT.RELATION of the 2nd record Parameters: Name Type Description name string value string | number Source: remote-objects/edit-relation.mjs, line 122 updateReciprocityFields(fieldsObj) Updates the field values of a reciprocity table view, e.g. CONT_CONT.RELATION of the 2nd record Parameters: Name Type Description fieldsObj object e.g. {\"OPENED\": \"0\"} Source: remote-objects/edit-relation.mjs, line 131 × Search results Close Efficy Enterprise API for Node.js and browser "},"ListObject.html":{"id":"ListObject.html","title":"Class: ListObject","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Class: ListObject ListObject Class uses by operations that return a list new ListObject() Properties: Name Type Description map Map The Map object holds key-value pairs and remembers the original order of the keys, https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map Source: remote-objects/list/list-object.mjs, line 8 Extends RemoteObject Methods &lt;protected&gt; afterExecute() Source: remote-objects/list/list-object.mjs, line 17 × Search results Close Efficy Enterprise API for Node.js and browser "},"StringObject.html":{"id":"StringObject.html","title":"Class: StringObject","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Class: StringObject StringObject Class uses by operations that return a string result new StringObject() Properties: Name Type Description result string Source: remote-objects/base-type/string-object.mjs, line 8 Extends RemoteObject Members &lt;protected&gt; operationName Source: remote-objects/base-type/string-object.mjs, line 11 Methods &lt;protected&gt; afterExecute() Source: remote-objects/base-type/string-object.mjs, line 19 × Search results Close Efficy Enterprise API for Node.js and browser "},"WsObject.html":{"id":"WsObject.html","title":"Class: WsObject","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Class: WsObject WsObject Class with methods that contain executeBatch commands new WsObject() Source: ws-objects/ws-object.mjs, line 9 Extends RemoteObject Methods &lt;async&gt; cleanupFiles(editObject [, filter] [, keepTopX]) Instantly cleanup files, but keep top X, optionally SQL expression filtered Parameters: Name Type Argument Default Description editObject EditObject filter string &lt;optional&gt; \"\" SQL filter expression, e.g. \"COMMENT like '%template%'\" keepTopX number &lt;optional&gt; 7 Keep only the top X files, sorted highest/latest K_SORT first Source: ws-objects/ws-object.mjs, line 62 Example await crm.ws.cleanupFiles(document, \"\", 7); await crm.ws.cleanupFiles(document, `COMMENT like '%template%'`, 0); &lt;async&gt; deleteFiles(editObject [, filter]) Instantly delete files, optionally SQL expression filtered Parameters: Name Type Argument Default Description editObject EditObject filter string &lt;optional&gt; \"\" SQL filter expression, e.g. \"COMMENT like '%template%'\" Source: ws-objects/ws-object.mjs, line 45 Example await crm.ws.deleteFiles(document); await crm.ws.deleteFiles(document, `COMMENT like '%template%'`); &lt;async&gt; getFiles(editObject, filter, includeBlobContent) Parameters: Name Type Description editObject EditObject filter string Server-side SQL filter expression, added as filter property of [TDataSet](https://help.efficy.io/extras/serverjs.html#TDataSet) includeBlobContent boolean On true, returns all blob streams (e.g. attachment, thumb) Source: ws-objects/ws-object.mjs, line 23 Returns: Type Promise.&lt;Array&gt; Example await crm.ws.getFiles(document, `COMMENT like '%.docx'`, false); × Search results Close Efficy Enterprise API for Node.js and browser "},"tutorial-Contribute.html":{"id":"tutorial-Contribute.html","title":"Tutorial: Contribute","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Contribute The Efficy Enterprise API is developed with Visual Studio Code and Node.js v16.13.2 Required npm packages Some packages are interesting for global usage (one time installation) for other Node.js projects, e.g. jsDoc and rollup: npm install --save-dev --global jsdoc npm install --save-dev --global rollup DocStrap is Bootstrap based template for JSDoc3. In addition, it includes all of the themes from Bootswatch giving you a great deal of look and feel options for your documentation, along with a simple search. Additionally, it adds some options to the conf.json file that gives you even more flexibility to tweak the template to your needs. It will also make your teeth whiter. We create .d.ts Files from.js files, this set up means you can own the editor experience of TypeScript-powered editors without porting your project to TypeScript, or having to maintain .d.ts files in your codebase. TypeScript supports most JSDoc tags. npm install --save-dev rollup-plugin-ignore npm install --save-dev ink-docstrap npm install --save-dev typescript Usage of Rollup Usage guide Rollup is a module bundler for JavaScript which compiles small pieces of code into something larger and more complex, such as a library or application. We use it for bundling the distribution module for the browser, e.g. efficy-enterprise-api-browser-es.js Execute rollup with default config file rollup.config.js rollup -c Usage of jsDoc With jsDoc, we generate the documentation and tutorials you current are reading! The jsDoc generation configuration in JSON format: jsdoc.conf.json. For the compile, we use templates jsdoc --configure jsdoc.conf.json --template ./node_modules/ink-docstrap/template Generate typings We create .d.ts Files from.js files, this set up means you can own the editor experience of TypeScript-powered editors without porting your project to TypeScript, or having to maintain .d.ts files in your codebase. TypeScript supports most JSDoc tags. This command uses tsconfig.json npx -p typescript tsc Publish package to npm A package manager for JavaScript, included with Node.js Login to https://www.npmjs.com/ In your local terminal, execute npm adduser to setup a one-time password (OTP) with your npmjs credentials. The OTP is sent by e-mail. Execute npm publish This development is npm package is named efficy-enterprise-api Install npm i efficy-enterprise-api To publish updates, first increment the version, e.g. npm version patch Commit git changes and npm publish npm publish × Search results Close Efficy Enterprise API for Node.js and browser "},"tutorial-CRM Environment.html":{"id":"tutorial-CRM Environment.html","title":"Tutorial: CRM Environment","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document CRM Environment For Node.js only, setup your CrmEnv (CRM Environment) parameters. The recommended authentication kind is with an API key. Another possibility is passing user and pwd credentials. const crmEnv = new CrmEnv({ \"url\": \"http://efficy120/\", \"customer\": \"efficy120\", \"apiKey\": \"86E353284C0C4A848F7ADEA13589C8B6\", \"logOff\": false, \"user\": \"\", \"pwd\": \"\" }); Don't use CrmEnv in a client-side an Efficy session × Search results Close Efficy Enterprise API for Node.js and browser "},"tutorial-Execute Queries and Searches.html":{"id":"tutorial-Execute Queries and Searches.html","title":"Tutorial: Execute Queries and Searches","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Execute Queries and Searches Usage examples of the availabel Query and Search operations const tags = crm.executeDatabaseQuery(99990034); // query \"Standard: Top company tags\" const contDupls = crm.executeSystemQuery(4, 1, [11000,2]); // System query \"Own Duplicate List\" const appos = crm.executeSqlQuery(\"Select * from ACTIONS where PLANNED=:p1 and DONE=:p2\", [\"1\", \"0\"], true, 2); const compSearch = crm.search(\"comp\", \"SEARCHFAST\", \"Efficy\"); const contactsByEmail = crm.searchContactsByEmail([\"john.doe@efficy.com\", \"john.doe@outlook.com\"]); const contactsByPhone = crm.searchContactsByPhone(\"+32 470 00 00 00\"); await crm.executeBatch(); // After the batch is executed, each constant is a object of type DataSetObject console.log(tags.items) // Array of items console.log(tags.items) // First item of array of items See DataSetObject × Search results Close Efficy Enterprise API for Node.js and browser "},"tutorial-Insert document.html":{"id":"tutorial-Insert document.html","title":"Tutorial: Insert document","body":" Efficy Enterprise API Classes AttachmentObjectCollectionObjectConsultObjectCrmEnvCrmRpcDataSetObjectDeleteEntityEditObjectEditRelationObjectListObjectStringObjectWsObject Tutorials ContributeCRM EnvironmentExecute Queries and SearchesInsert document Insert document Insert and commit a new document. Add relations with Contacts, Companies, Products. Activate and update a category. Set linked users and a unique reference. const crm = new CrmRpc(crmEnv); const docu = crm.openEditObject(\"docu\", 0); docu.updateField(\"NAME\", \"Hello from Node.js\"); docu.insertDetail(\"Comp\", 2); docu.insertDetail(\"Cont\", 44395, true, true); docu.commitChanges(); docu.activateCategory(\"DOCU$INVOICING\"); docu.updateCategoryFields(\"DOCU$INVOICING\", { \"D_INVOICE\":\"2021-01-08T00:00:00\", \"COMMUNICATION\": \"Hello World!\" }); docu.updateCategoryField(\"DOCU$INVOICING\", \"PRE_PAID\", 123.456) docu.clearDetail(\"Comp\"); docu.insertDetail(\"Comp\", 4); docu.insertDetail(\"Cont\", 50512, false); docu.insertDetail(\"Prod\", 4); docu.updateDetail(\"Prod\", 0, { QUANTITY: 5 }); docu.setUsers([169, 170], true); docu.setUserSecurity(99999002, 271); docu.setReference(99999001); docu.commitChanges(); docu.closeContext(); await crm.executeBatch(); × Search results Close Efficy Enterprise API for Node.js and browser "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
